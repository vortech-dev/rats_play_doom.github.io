<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rats Play Doom</title>
    <link rel="icon" href="images/logo.png" type="image/x-icon">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

    <!-- Babylon.js for 3D viewer -->
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>

    <!-- Local JS for 3D viewer -->
    <script defer src="assets/js/util.js"></script>
    <script defer src="assets/js/main.js"></script>
</head>
<body>
    <header id="header">
        <h1>Rats Play DOOM</h1>
        <div class="contact-links">
            <a href="javascript:void(0);" class="contact-link anim-float-1" id="contact-email" data-email="viktor@yolorun.capital">ðŸ“§ viktor@yolorun.capital</a>
            <a href="https://yolorun.capital" target="_blank" class="contact-link" id="contact-yolorun">ðŸ’° YoloRun.Capital</a>
            <a href="https://medium.com/mindsoft" target="_blank" class="contact-link anim-pulse-1" id="contact-medium">ðŸ§  Mindsoft @ Medium</a>
            <a href="https://www.vice.com/en/article/i-trained-rats-science-experiment-to-become-doom-2-gamers" target="_blank" class="contact-link anim-color-shift-1" id="contact-vice"><img src="assets/images/logos/Vice_Logo.svg" alt="Vice Logo" class="contact-logo invert-logo"> Article</a>
            <a href="https://www.pcgamer.com/rats-named-carmack-and-romero-are-playing-doom" target="_blank" class="contact-link anim-float-2" id="contact-pcgamer"><img src="assets/images/logos/PC_Gamer_logo.svg" alt="PC Gamer Logo" class="contact-logo"> Article</a>
            <a href="https://github.com/csiki/rat_vr2" target="_blank" class="contact-link" id="contact-github">ðŸ’» GitHub Repo</a>
            <a href="https://x.com/yolorun_capital" target="_blank" class="contact-link anim-pulse-2" id="contact-x">&#x1D54F; YoloRun</a>
        </div>
        <nav>
            <a href="#intro">Intro</a>
            <a href="#hardware">Hardware</a>
            <a href="#software">Software</a>
            <a href="#results">Results</a>
        </nav>
    </header>

    <main>
        <section id="intro">
            <h2>Intro</h2>
            <p>We built a complete VR setup from scratch to let rats play DOOM. The system includes a motion-tracked treadmill ball, a panoramic headset, an input trigger, and a reward circuit. All hardware and software components are open sourced, including 3D-printable designs, circuit diagrams, firmware, and control software.</p>
            <p>The first version (v1) was built in New York by Viktor, who trained rats to walk through a corridor in DOOM using a simpler rig. That version was featured on Vice and PC Gamer. After moving back home, the project was paused. Public interest reignited development, leading to v2, a more advanced and modular version built in collaboration with electrical engineer SÃ¡ndor Makra.</p>

            <h3>V1</h3>
            <ul>
                <li>Basic ball setup</li>
                <li>Rats trained to run forward</li>
                <li>Minimal sensors and mechanics</li>
                <li>No panoramic screen</li>
            </ul>

            <h3>V2</h3>
            <ul>
                <li>New ball driver mechanism for smoother movement</li>
                <li>Foldable AMOLED screen with 180Â° horizontal and 80Â° vertical FOV, Full HD resolution</li>
                <li>Upgraded sensors for movement tracking</li>
                <li>Reinforced feeder system with mixing motor</li>
                <li>Modular 3D-printable components</li>
                <li>Improved electronics reliability and safety</li>
            </ul>

            <figure>
                <img src="images/placeholder_setup_side.png" alt="Full setup from side showing rat on ball, screen around, trigger, and water tube.">
                <figcaption>Full setup from side showing rat on ball, screen around, trigger, and water tube.</figcaption>
            </figure>

            <h3>Limitations</h3>
            <p>We reached the point of rat habituation but didnâ€™t start training. Our rats (Todd, Kojima, Gabe) aged out before full testing. The setup works, but behavioral validation is pending.</p>
        </section>

        <section id="hardware">
            <h2>Hardware</h2>

            <article>
                <h3>Visual Interface</h3>
                <p>The headset wraps around the ratâ€™s head with a foldable AMOLED screen. It maximizes immersion without obstructing whisker space. The screen supports Full HD resolution.</p>
                <div class="viewer-container">
                    <canvas id="headsetCanvas"></canvas>
                    <figure>
                        <img src="images/placeholder_headset_above.png" alt="Headset close-up from above.">
                        <figcaption>Headset close-up from above.</figcaption>
                    </figure>
                </div>
                 <p class="model-label">3D Model: Headset</p>
            </article>

            <article>
                <h3>Locomotion</h3>
                <p>Movement is captured via a free-spinning ball under the rat. Rotary sensors track displacement and convert it into game motion. The ball can also be driven by motors.</p>
                <p>These motors are used during training to roll the ball and simulate movement paths before a reward. This guides the rat on where to go, helping form movement-action associations. Like the trigger, this allows for programmatic training sequences with minimal initial input from the animal.</p>
                 <div class="viewer-container">
                    <canvas id="standCanvas"></canvas>
                    <figure>
                        <img src="images/placeholder_ball_mount.png" alt="Ball mount showing driven/undriven modes and sensor placement.">
                        <figcaption>Ball mount showing driven/undriven modes and sensor placement.</figcaption>
                    </figure>
                </div>
                 <p class="model-label">3D Model: Stand/Ball</p>
            </article>

            <article>
                <h3>Trigger Input</h3>
                <p>The shooting input is a custom-built hand-operated lever. Rats pull it with their paws to fire. The lever is held in place by small springs, encased in a 3D-printed housing. It includes a rotary encoder to detect motion and a stepper motor to actuate it.</p>
                <p>The motor allows programmatic controlâ€”pulling the lever to demonstrate shooting. This enables training by pairing visual cues with mechanical motion, reinforcing the association before the rat initiates the action on its own.</p>
                 <div class="viewer-container">
                     <canvas id="triggerCanvas"></canvas>
                    <figure>
                        <img src="images/placeholder_trigger_lever.png" alt="Close-up of trigger lever with encoder and motor.">
                        <figcaption>Close-up of trigger lever with encoder and motor.</figcaption>
                    </figure>
                </div>
                <p class="model-label">3D Model: Trigger</p>
            </article>

            <article>
                <h3>Reward System</h3>
                <p>Positive in-game actions trigger a liquid reward: sugar water delivered through a precise dispensing mechanism. The system consists of:</p>
                <ul>
                    <li>Mixer: Continuously stirs the sugar solution to maintain even concentration</li>
                    <li>Pump + Pressure Sensor: Keeps the line under constant pressure</li>
                    <li>Solenoid Valve: Magnetic valve that opens to release exact 10 ÂµL doses</li>
                    <li>Dispenser: Positioned near the mouth for easy access</li>
                </ul>
                <p>This setup ensures accurate, repeatable reward delivery with minimal delay. The reward is synchronized with game events to reinforce desired behaviors.</p>
                <figure>
                    <img src="images/placeholder_reward_circuit.png" alt="Reward circuit with labeled mixer, pump, valve, and dispenser.">
                    <figcaption>Reward circuit diagram.</figcaption>
                </figure>
            </article>

            <article>
                <h3>Limitations</h3>
                <p>The current system assumes basic rat mobility and grooming behavior. Fine-tuning might be needed for rats of different sizes or temperaments. Trigger placement and reward tube flow may need calibration per subject.</p>
            </article>
        </section>

        <section id="software">
            <h2>Software</h2>
            <p>The setup is controlled through a modular Python system. The main entry point is <code>arena_scenario.py</code>, which runs the full control loop.</p>
            <p>The system includes:</p>
            <ul>
                <li>Motion capture: Reads movement from optical flow sensors mounted around the treadmill ball.</li>
                <li>Locomotion control: Drives the ball motors to guide the rat during training.</li>
                <li>Trigger input: Reads lever pulls, detects voluntary shooting actions.</li>
                <li>Reward delivery: Dispenses precise 10 Î¼L sugar water rewards via a controlled solenoid valve and maintains constant line pressure.</li>
                <li>DOOM integration: Interfaces with a modified ViZDoom environment for real-time closed-loop behavior.</li>
                <li>Training logic: Enforces demonstrations and delivers rewards based on game state and rat behavior.</li>
            </ul>
            <p>The software runs on a PC and communicates with a Raspberry Pi via TCP sockets. The Pi handles real-time sensor reading, ball actuation, and reward control; the PC processes the sensor data, runs the game, and sends high-level commands to the Pi.</p>
            <p>All major componentsâ€”movement tracking, ball driving, trigger detection, and reward controlâ€”can be operated manually or in closed-loop mode. All control parameters (e.g., motor speeds, reward volumes) are set in Python code.</p>
            <figure>
                <img src="images/placeholder_software_diagram.png" alt="Diagram showing PC-Pi communication, sensors, motors, and game loop overview.">
                <figcaption>System architecture diagram.</figcaption>
            </figure>

            <h3>Limitations</h3>
            <p>Thereâ€™s no in-built calibration suite. Users must validate sensor alignment and reward timing manually. Some microcontroller firmwares might require tuning based on hardware tolerances.</p>
        </section>

        <section id="results">
            <h2>Results</h2>
            <p>We validated the hardware and software setup up to the habituation phase. The rats stood calmly on the platform and tolerated the headset and feeder tube.</p>
            <div class="video-placeholder">
                 [VIDEO: Rat standing on platform with panoramic screen active.]
            </div>
            <p>Observed:</p>
            <ul>
                <li>Stable platform behavior for minutes</li>
                <li>Responsive and accurate ball motion tracking</li>
                <li>Reliable programmatic control of both ball driving and trigger actuation</li>
                <li>Reliable feeder system dispensing small, precise water rewards</li>
            </ul>
            <h3>Limitations</h3>
            <p>The rats did not interact with the trigger during tests. Full gameplay training was not completed. Behavioral validation remains pending for future trials with younger rats.</p>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Rats Play Doom Project - Open Source Hardware & Software</p>
        <!-- Add links to GitHub repo, etc. here later -->
    </footer>

</body>
</html>
